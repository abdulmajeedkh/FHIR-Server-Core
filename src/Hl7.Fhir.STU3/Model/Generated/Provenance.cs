// <auto-generated/>
// Contents of: hl7.fhir.r3.expansions@3.0.2, hl7.fhir.r3.core@3.0.2

using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using Hl7.Fhir.Introspection;
using Hl7.Fhir.Serialization;
using Hl7.Fhir.Specification;
using Hl7.Fhir.Utility;
using Hl7.Fhir.Validation;
using System.Diagnostics.CodeAnalysis;
using SystemPrimitive = Hl7.Fhir.ElementModel.Types;

#nullable enable

/*
  Copyright (c) 2011+, HL7, Inc.
  All rights reserved.
  
  Redistribution and use in source and binary forms, with or without modification, 
  are permitted provided that the following conditions are met:
  
   * Redistributions of source code must retain the above copyright notice, this 
     list of conditions and the following disclaimer.
   * Redistributions in binary form must reproduce the above copyright notice, 
     this list of conditions and the following disclaimer in the documentation 
     and/or other materials provided with the distribution.
   * Neither the name of HL7 nor the names of its contributors may be used to 
     endorse or promote products derived from this software without specific 
     prior written permission.
  
  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND 
  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED 
  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, 
  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT 
  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR 
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) 
  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE 
  POSSIBILITY OF SUCH DAMAGE.
  
*/

namespace Hl7.Fhir.Model
{
  /// <summary>
  /// Who, What, When for a set of resources
  /// </summary>
  /// <remarks>
  /// Provenance of a resource is a record that describes entities and processes involved in producing and delivering or otherwise influencing that resource. Provenance provides a critical foundation for assessing authenticity, enabling trust, and allowing reproducibility. Provenance assertions are a form of contextual metadata and can themselves become important records with their own provenance. Provenance statement indicates clinical significance in terms of confidence in authenticity, reliability, and trustworthiness, integrity, and stage in lifecycle (e.g. Document Completion - has the artifact been legally authenticated), all of which may impact security, privacy, and trust policies.
  /// Some parties may be duplicated between the target resource and its provenance.  For instance, the prescriber is usually (but not always) the author of the prescription resource. This resource is defined with close consideration for W3C Provenance.
  /// </remarks>
  [Serializable]
  [DataContract]
  [FhirType("Provenance","http://hl7.org/fhir/StructureDefinition/Provenance")]
  public partial class Provenance : Hl7.Fhir.Model.DomainResource
  {
    /// <summary>
    /// FHIR Type Name
    /// </summary>
    public override string TypeName => "Provenance";

    /// <summary>
    /// How an entity was used in an activity.
    /// (url: http://hl7.org/fhir/ValueSet/provenance-entity-role)
    /// (system: http://hl7.org/fhir/provenance-entity-role)
    /// </summary>
    [FhirEnumeration("ProvenanceEntityRole", "http://hl7.org/fhir/ValueSet/provenance-entity-role", "http://hl7.org/fhir/provenance-entity-role")]
    public enum ProvenanceEntityRole
    {
      /// <summary>
      /// A transformation of an entity into another, an update of an entity resulting in a new one, or the construction of a new entity based on a preexisting entity.
      /// (system: http://hl7.org/fhir/provenance-entity-role)
      /// </summary>
      [EnumLiteral("derivation"), Description("Derivation")]
      Derivation,
      /// <summary>
      /// A derivation for which the resulting entity is a revised version of some original.
      /// (system: http://hl7.org/fhir/provenance-entity-role)
      /// </summary>
      [EnumLiteral("revision"), Description("Revision")]
      Revision,
      /// <summary>
      /// The repeat of (some or all of) an entity, such as text or image, by someone who may or may not be its original author.
      /// (system: http://hl7.org/fhir/provenance-entity-role)
      /// </summary>
      [EnumLiteral("quotation"), Description("Quotation")]
      Quotation,
      /// <summary>
      /// A primary source for a topic refers to something produced by some agent with direct experience and knowledge about the topic, at the time of the topic's study, without benefit from hindsight.
      /// (system: http://hl7.org/fhir/provenance-entity-role)
      /// </summary>
      [EnumLiteral("source"), Description("Source")]
      Source,
      /// <summary>
      /// A derivation for which the entity is removed from accessibility usually through the use of the Delete operation.
      /// (system: http://hl7.org/fhir/provenance-entity-role)
      /// </summary>
      [EnumLiteral("removal"), Description("Removal")]
      Removal,
    }

    /// <summary>
    /// Actor involved
    /// </summary>
    /// <remarks>
    /// An actor taking a role in an activity  for which it can be assigned some degree of responsibility for the activity taking place.
    /// Several agents may be associated (i.e. has some responsibility for an activity) with an activity and vice-versa.
    /// </remarks>
    [Serializable]
    [DataContract]
    [FhirType("Provenance.agent", IsBackboneType=true)]
    public partial class AgentComponent : Hl7.Fhir.Model.BackboneElement
    {
      /// <summary>
      /// FHIR Type Name
      /// </summary>
      public override string TypeName => "Provenance.agent";

      /// <summary>
      /// What the agents role was.
      /// </summary>
      [FhirElement("role", InSummary=true, Order=40)]
      [Binding("ProvenanceAgentRole")]
      [Cardinality(Min=0,Max=-1)]
      [DataMember]
      [AllowNull]
      public List<Hl7.Fhir.Model.CodeableConcept> Role
      {
        get
        {
          if(_Role.InOverflow<List<Hl7.Fhir.Model.CodeableConcept>>())
            throw CodedValidationException.FromTypes(typeof(List<Hl7.Fhir.Model.CodeableConcept>), Overflow["role"]);
          return _Role ??= [];
        }

        set
        {
          if (_Role.InOverflow<List<Hl7.Fhir.Model.CodeableConcept>>())
            Overflow.Remove("role");
          _Role = value;
          OnPropertyChanged("Role");
        }

      }

      private List<Hl7.Fhir.Model.CodeableConcept>? _Role;

      /// <summary>
      /// Who participated.
      /// </summary>
      [FhirElement("who", InSummary=true, Order=50, Choice=ChoiceType.DatatypeChoice, FiveWs="who.actor")]
      [CLSCompliant(false)]
      [References("Practitioner","RelatedPerson","Patient","Device","Organization")]
      [AllowedTypes(typeof(Hl7.Fhir.Model.FhirUri),typeof(Hl7.Fhir.Model.ResourceReference))]
      [Cardinality(Min=1,Max=1)]
      [DataMember]
      public Hl7.Fhir.Model.DataType Who
      {
        get
        {
          if(_Who.InOverflow<DynamicDataType>())
            throw CodedValidationException.FromTypes(typeof(Hl7.Fhir.Model.DataType), Overflow["who"]);
          return _Who!;
        }

        set
        {
          if (_Who.InOverflow<DynamicDataType>())
            Overflow.Remove("who");
          _Who = value;
          OnPropertyChanged("Who");
        }

      }

      private Hl7.Fhir.Model.DataType? _Who;

      /// <summary>
      /// Who the agent is representing.
      /// </summary>
      [FhirElement("onBehalfOf", Order=60, Choice=ChoiceType.DatatypeChoice)]
      [CLSCompliant(false)]
      [References("Practitioner","RelatedPerson","Patient","Device","Organization")]
      [AllowedTypes(typeof(Hl7.Fhir.Model.FhirUri),typeof(Hl7.Fhir.Model.ResourceReference))]
      [DataMember]
      public Hl7.Fhir.Model.DataType? OnBehalfOf
      {
        get
        {
          if(_OnBehalfOf.InOverflow<DynamicDataType>())
            throw CodedValidationException.FromTypes(typeof(Hl7.Fhir.Model.DataType), Overflow["onBehalfOf"]);
          return _OnBehalfOf;
        }

        set
        {
          if (_OnBehalfOf.InOverflow<DynamicDataType>())
            Overflow.Remove("onBehalfOf");
          _OnBehalfOf = value;
          OnPropertyChanged("OnBehalfOf");
        }

      }

      private Hl7.Fhir.Model.DataType? _OnBehalfOf;

      /// <summary>
      /// Type of relationship between agents.
      /// </summary>
      [FhirElement("relatedAgentType", Order=70)]
      [Binding("RelatedAgentType")]
      [DataMember]
      public Hl7.Fhir.Model.CodeableConcept? RelatedAgentType
      {
        get
        {
          if(_RelatedAgentType.InOverflow<Hl7.Fhir.Model.CodeableConcept>())
            throw CodedValidationException.FromTypes(typeof(Hl7.Fhir.Model.CodeableConcept), Overflow["relatedAgentType"]);
          return _RelatedAgentType;
        }

        set
        {
          if (_RelatedAgentType.InOverflow<Hl7.Fhir.Model.CodeableConcept>())
            Overflow.Remove("relatedAgentType");
          _RelatedAgentType = value;
          OnPropertyChanged("RelatedAgentType");
        }

      }

      private Hl7.Fhir.Model.CodeableConcept? _RelatedAgentType;

      protected internal override void CopyToInternal(Base other)
      {
        if(other is not AgentComponent dest)
          throw new ArgumentException("Can only copy to an object of the same type", "other");

        base.CopyToInternal(dest);
        if(_Role is not null) dest.Role = new List<Hl7.Fhir.Model.CodeableConcept>(_Role.DeepCopyInternal());
        if(_Who is not null) dest.Who = (Hl7.Fhir.Model.DataType)_Who.DeepCopyInternal();
        if(_OnBehalfOf is not null) dest.OnBehalfOf = (Hl7.Fhir.Model.DataType)_OnBehalfOf.DeepCopyInternal();
        if(_RelatedAgentType is not null) dest.RelatedAgentType = (Hl7.Fhir.Model.CodeableConcept)_RelatedAgentType.DeepCopyInternal();
      }

      protected internal override Base DeepCopyInternal()
      {
        var instance = new AgentComponent();
        CopyToInternal(instance);
        return instance;
      }

      public override bool CompareChildren(Base other, IEqualityComparer<Base> comparer)
      {
        if(other is not AgentComponent otherT) return false;

        if(!base.CompareChildren(otherT, comparer)) return false;
        #pragma warning disable CS8604 // Possible null reference argument - netstd2.1 has a wrong nullable signature here
        if(!comparer.ListEquals(_Role, otherT._Role)) return false;
        if(!comparer.Equals(_Who, otherT._Who)) return false;
        if(!comparer.Equals(_OnBehalfOf, otherT._OnBehalfOf)) return false;
        if(!comparer.Equals(_RelatedAgentType, otherT._RelatedAgentType)) return false;
        #pragma warning restore CS8604 // Possible null reference argument.

        return true;
      }

      public override bool TryGetValue(string key, [NotNullWhen(true)] out object? value)
      {
        switch (key)
        {
          case "role":
            if (_Role.InOverflow<List<Hl7.Fhir.Model.CodeableConcept>>())
            {
              value = Overflow["role"];
              return true;
            }
            value = _Role;
            return (value as List<Hl7.Fhir.Model.CodeableConcept>)?.Any() is true;
          case "who":
            if (_Who.InOverflow<DynamicDataType>())
            {
              value = Overflow["who"];
              return true;
            }
            value = _Who;
            return (value as Hl7.Fhir.Model.DataType) is not null;
          case "onBehalfOf":
            if (_OnBehalfOf.InOverflow<DynamicDataType>())
            {
              value = Overflow["onBehalfOf"];
              return true;
            }
            value = _OnBehalfOf;
            return (value as Hl7.Fhir.Model.DataType) is not null;
          case "relatedAgentType":
            if (_RelatedAgentType.InOverflow<Hl7.Fhir.Model.CodeableConcept>())
            {
              value = Overflow["relatedAgentType"];
              return true;
            }
            value = _RelatedAgentType;
            return (value as Hl7.Fhir.Model.CodeableConcept) is not null;
          default:
            return base.TryGetValue(key, out value);
        }

      }

      public override Base SetValue(string key, object? value)
      {
        if(value is not (null or Hl7.Fhir.Model.Base or IList)) throw new ArgumentException("Value must be a Base or a list of Base", nameof(value));
        switch (key)
        {
          case "role":
            if (value is not (List<Hl7.Fhir.Model.CodeableConcept> or null))
            {
              Role = OverflowNull<List<Hl7.Fhir.Model.CodeableConcept>>.INSTANCE;
              Overflow["role"] = value;
            }
            else Role = (List<Hl7.Fhir.Model.CodeableConcept>?)value!;
            return this;
          case "who":
            if (value is not (Hl7.Fhir.Model.DataType or null))
            {
              Who = OverflowNull<DynamicDataType>.INSTANCE;
              Overflow["who"] = value;
            }
            else Who = (Hl7.Fhir.Model.DataType?)value!;
            return this;
          case "onBehalfOf":
            if (value is not (Hl7.Fhir.Model.DataType or null))
            {
              OnBehalfOf = OverflowNull<DynamicDataType>.INSTANCE;
              Overflow["onBehalfOf"] = value;
            }
            else OnBehalfOf = (Hl7.Fhir.Model.DataType?)value;
            return this;
          case "relatedAgentType":
            if (value is not (Hl7.Fhir.Model.CodeableConcept or null))
            {
              RelatedAgentType = OverflowNull<Hl7.Fhir.Model.CodeableConcept>.INSTANCE;
              Overflow["relatedAgentType"] = value;
            }
            else RelatedAgentType = (Hl7.Fhir.Model.CodeableConcept?)value;
            return this;
          default:
            return base.SetValue(key, value);
        }

      }

      public override IEnumerable<KeyValuePair<string, object>> EnumerateElements()
      {
        foreach (var kvp in base.EnumerateElements()) yield return kvp;
        if (_Role?.Any() is true && !_Role.InOverflow<List<Hl7.Fhir.Model.CodeableConcept>>()) yield return new KeyValuePair<string,object>("role",_Role);
        if (_Who is not null && !_Who.InOverflow<DynamicDataType>()) yield return new KeyValuePair<string,object>("who",_Who);
        if (_OnBehalfOf is not null && !_OnBehalfOf.InOverflow<DynamicDataType>()) yield return new KeyValuePair<string,object>("onBehalfOf",_OnBehalfOf);
        if (_RelatedAgentType is not null && !_RelatedAgentType.InOverflow<Hl7.Fhir.Model.CodeableConcept>()) yield return new KeyValuePair<string,object>("relatedAgentType",_RelatedAgentType);
      }

    }

    /// <summary>
    /// An entity used in this activity
    /// </summary>
    /// <remarks>
    /// Multiple userIds may be associated with the same Practitioner or other individual across various appearances, each with distinct privileges.
    /// </remarks>
    [Serializable]
    [DataContract]
    [FhirType("Provenance.entity", IsBackboneType=true)]
    public partial class EntityComponent : Hl7.Fhir.Model.BackboneElement
    {
      /// <summary>
      /// FHIR Type Name
      /// </summary>
      public override string TypeName => "Provenance.entity";

      /// <summary>
      /// derivation | revision | quotation | source | removal.
      /// </summary>
      [FhirElement("role", InSummary=true, Order=40)]
      [Binding("ProvenanceEntityRole")]
      [Cardinality(Min=1,Max=1)]
      [DataMember]
      public Code<Hl7.Fhir.Model.Provenance.ProvenanceEntityRole> RoleElement
      {
        get
        {
          if(_RoleElement.InOverflow<Code<Hl7.Fhir.Model.Provenance.ProvenanceEntityRole>>())
            throw CodedValidationException.FromTypes(typeof(Code<Hl7.Fhir.Model.Provenance.ProvenanceEntityRole>), Overflow["role"]);
          return _RoleElement!;
        }

        set
        {
          if (_RoleElement.InOverflow<Code<Hl7.Fhir.Model.Provenance.ProvenanceEntityRole>>())
            Overflow.Remove("role");
          _RoleElement = value;
          OnPropertyChanged("RoleElement");
        }

      }

      private Code<Hl7.Fhir.Model.Provenance.ProvenanceEntityRole>? _RoleElement;

      /// <summary>
      /// derivation | revision | quotation | source | removal
      /// </summary>
      /// <remarks>This uses the native .NET datatype, rather than the FHIR equivalent</remarks>
      [IgnoreDataMember]
      public Hl7.Fhir.Model.Provenance.ProvenanceEntityRole? Role
      {
        get => RoleElement?.Value;
        set
        {
          RoleElement = value is null ? null! : new Code<Hl7.Fhir.Model.Provenance.ProvenanceEntityRole>(value);
          OnPropertyChanged("Role");
        }
      }

      /// <summary>
      /// Identity of entity.
      /// </summary>
      [FhirElement("what", InSummary=true, Order=50, Choice=ChoiceType.DatatypeChoice)]
      [CLSCompliant(false)]
      [References("Resource")]
      [AllowedTypes(typeof(Hl7.Fhir.Model.FhirUri),typeof(Hl7.Fhir.Model.ResourceReference),typeof(Hl7.Fhir.Model.Identifier))]
      [Cardinality(Min=1,Max=1)]
      [DataMember]
      public Hl7.Fhir.Model.DataType What
      {
        get
        {
          if(_What.InOverflow<DynamicDataType>())
            throw CodedValidationException.FromTypes(typeof(Hl7.Fhir.Model.DataType), Overflow["what"]);
          return _What!;
        }

        set
        {
          if (_What.InOverflow<DynamicDataType>())
            Overflow.Remove("what");
          _What = value;
          OnPropertyChanged("What");
        }

      }

      private Hl7.Fhir.Model.DataType? _What;

      /// <summary>
      /// Entity is attributed to this agent.
      /// </summary>
      [FhirElement("agent", Order=60)]
      [Cardinality(Min=0,Max=-1)]
      [DataMember]
      [AllowNull]
      public List<Hl7.Fhir.Model.Provenance.AgentComponent> Agent
      {
        get
        {
          if(_Agent.InOverflow<List<Hl7.Fhir.Model.Provenance.AgentComponent>>())
            throw CodedValidationException.FromTypes(typeof(List<Hl7.Fhir.Model.Provenance.AgentComponent>), Overflow["agent"]);
          return _Agent ??= [];
        }

        set
        {
          if (_Agent.InOverflow<List<Hl7.Fhir.Model.Provenance.AgentComponent>>())
            Overflow.Remove("agent");
          _Agent = value;
          OnPropertyChanged("Agent");
        }

      }

      private List<Hl7.Fhir.Model.Provenance.AgentComponent>? _Agent;

      protected internal override void CopyToInternal(Base other)
      {
        if(other is not EntityComponent dest)
          throw new ArgumentException("Can only copy to an object of the same type", "other");

        base.CopyToInternal(dest);
        if(_RoleElement is not null) dest.RoleElement = (Code<Hl7.Fhir.Model.Provenance.ProvenanceEntityRole>)_RoleElement.DeepCopyInternal();
        if(_What is not null) dest.What = (Hl7.Fhir.Model.DataType)_What.DeepCopyInternal();
        if(_Agent is not null) dest.Agent = new List<Hl7.Fhir.Model.Provenance.AgentComponent>(_Agent.DeepCopyInternal());
      }

      protected internal override Base DeepCopyInternal()
      {
        var instance = new EntityComponent();
        CopyToInternal(instance);
        return instance;
      }

      public override bool CompareChildren(Base other, IEqualityComparer<Base> comparer)
      {
        if(other is not EntityComponent otherT) return false;

        if(!base.CompareChildren(otherT, comparer)) return false;
        #pragma warning disable CS8604 // Possible null reference argument - netstd2.1 has a wrong nullable signature here
        if(!comparer.Equals(_RoleElement, otherT._RoleElement)) return false;
        if(!comparer.Equals(_What, otherT._What)) return false;
        if(!comparer.ListEquals(_Agent, otherT._Agent)) return false;
        #pragma warning restore CS8604 // Possible null reference argument.

        return true;
      }

      public override bool TryGetValue(string key, [NotNullWhen(true)] out object? value)
      {
        switch (key)
        {
          case "role":
            if (_RoleElement.InOverflow<Code<Hl7.Fhir.Model.Provenance.ProvenanceEntityRole>>())
            {
              value = Overflow["role"];
              return true;
            }
            value = _RoleElement;
            return (value as Code<Hl7.Fhir.Model.Provenance.ProvenanceEntityRole>) is not null;
          case "what":
            if (_What.InOverflow<DynamicDataType>())
            {
              value = Overflow["what"];
              return true;
            }
            value = _What;
            return (value as Hl7.Fhir.Model.DataType) is not null;
          case "agent":
            if (_Agent.InOverflow<List<Hl7.Fhir.Model.Provenance.AgentComponent>>())
            {
              value = Overflow["agent"];
              return true;
            }
            value = _Agent;
            return (value as List<Hl7.Fhir.Model.Provenance.AgentComponent>)?.Any() is true;
          default:
            return base.TryGetValue(key, out value);
        }

      }

      public override Base SetValue(string key, object? value)
      {
        if(value is not (null or Hl7.Fhir.Model.Base or IList)) throw new ArgumentException("Value must be a Base or a list of Base", nameof(value));
        switch (key)
        {
          case "role":
            if (value is not (Code<Hl7.Fhir.Model.Provenance.ProvenanceEntityRole> or null))
            {
              RoleElement = OverflowNull<Code<Hl7.Fhir.Model.Provenance.ProvenanceEntityRole>>.INSTANCE;
              Overflow["role"] = value;
            }
            else RoleElement = (Code<Hl7.Fhir.Model.Provenance.ProvenanceEntityRole>?)value!;
            return this;
          case "what":
            if (value is not (Hl7.Fhir.Model.DataType or null))
            {
              What = OverflowNull<DynamicDataType>.INSTANCE;
              Overflow["what"] = value;
            }
            else What = (Hl7.Fhir.Model.DataType?)value!;
            return this;
          case "agent":
            if (value is not (List<Hl7.Fhir.Model.Provenance.AgentComponent> or null))
            {
              Agent = OverflowNull<List<Hl7.Fhir.Model.Provenance.AgentComponent>>.INSTANCE;
              Overflow["agent"] = value;
            }
            else Agent = (List<Hl7.Fhir.Model.Provenance.AgentComponent>?)value!;
            return this;
          default:
            return base.SetValue(key, value);
        }

      }

      public override IEnumerable<KeyValuePair<string, object>> EnumerateElements()
      {
        foreach (var kvp in base.EnumerateElements()) yield return kvp;
        if (_RoleElement is not null && !_RoleElement.InOverflow<Code<Hl7.Fhir.Model.Provenance.ProvenanceEntityRole>>()) yield return new KeyValuePair<string,object>("role",_RoleElement);
        if (_What is not null && !_What.InOverflow<DynamicDataType>()) yield return new KeyValuePair<string,object>("what",_What);
        if (_Agent?.Any() is true && !_Agent.InOverflow<List<Hl7.Fhir.Model.Provenance.AgentComponent>>()) yield return new KeyValuePair<string,object>("agent",_Agent);
      }

    }

    /// <summary>
    /// Target Reference(s) (usually version specific).
    /// </summary>
    [FhirElement("target", InSummary=true, Order=90, FiveWs="what")]
    [CLSCompliant(false)]
    [References("Resource")]
    [Cardinality(Min=1,Max=-1)]
    [DataMember]
    [AllowNull]
    public List<Hl7.Fhir.Model.ResourceReference> Target
    {
      get
      {
        if(_Target.InOverflow<List<Hl7.Fhir.Model.ResourceReference>>())
          throw CodedValidationException.FromTypes(typeof(List<Hl7.Fhir.Model.ResourceReference>), Overflow["target"]);
        return _Target ??= [];
      }

      set
      {
        if (_Target.InOverflow<List<Hl7.Fhir.Model.ResourceReference>>())
          Overflow.Remove("target");
        _Target = value;
        OnPropertyChanged("Target");
      }

    }

    private List<Hl7.Fhir.Model.ResourceReference>? _Target;

    /// <summary>
    /// When the activity occurred.
    /// </summary>
    [FhirElement("period", Order=100, FiveWs="when.done")]
    [DataMember]
    public Hl7.Fhir.Model.Period? Period
    {
      get
      {
        if(_Period.InOverflow<Hl7.Fhir.Model.Period>())
          throw CodedValidationException.FromTypes(typeof(Hl7.Fhir.Model.Period), Overflow["period"]);
        return _Period;
      }

      set
      {
        if (_Period.InOverflow<Hl7.Fhir.Model.Period>())
          Overflow.Remove("period");
        _Period = value;
        OnPropertyChanged("Period");
      }

    }

    private Hl7.Fhir.Model.Period? _Period;

    /// <summary>
    /// When the activity was recorded / updated.
    /// </summary>
    [FhirElement("recorded", InSummary=true, Order=110, FiveWs="when.recorded")]
    [Cardinality(Min=1,Max=1)]
    [DataMember]
    public Hl7.Fhir.Model.Instant RecordedElement
    {
      get
      {
        if(_RecordedElement.InOverflow<Hl7.Fhir.Model.Instant>())
          throw CodedValidationException.FromTypes(typeof(Hl7.Fhir.Model.Instant), Overflow["recorded"]);
        return _RecordedElement!;
      }

      set
      {
        if (_RecordedElement.InOverflow<Hl7.Fhir.Model.Instant>())
          Overflow.Remove("recorded");
        _RecordedElement = value;
        OnPropertyChanged("RecordedElement");
      }

    }

    private Hl7.Fhir.Model.Instant? _RecordedElement;

    /// <summary>
    /// When the activity was recorded / updated
    /// </summary>
    /// <remarks>This uses the native .NET datatype, rather than the FHIR equivalent</remarks>
    [IgnoreDataMember]
    public DateTimeOffset? Recorded
    {
      get => RecordedElement?.Value;
      set
      {
        RecordedElement = value is null ? null! : new Hl7.Fhir.Model.Instant(value);
        OnPropertyChanged("Recorded");
      }
    }

    /// <summary>
    /// Policy or plan the activity was defined by.
    /// </summary>
    [FhirElement("policy", Order=120)]
    [Cardinality(Min=0,Max=-1)]
    [DataMember]
    [AllowNull]
    public List<Hl7.Fhir.Model.FhirUri> PolicyElement
    {
      get
      {
        if(_PolicyElement.InOverflow<List<Hl7.Fhir.Model.FhirUri>>())
          throw CodedValidationException.FromTypes(typeof(List<Hl7.Fhir.Model.FhirUri>), Overflow["policy"]);
        return _PolicyElement ??= [];
      }

      set
      {
        if (_PolicyElement.InOverflow<List<Hl7.Fhir.Model.FhirUri>>())
          Overflow.Remove("policy");
        _PolicyElement = value;
        OnPropertyChanged("PolicyElement");
      }

    }

    private List<Hl7.Fhir.Model.FhirUri>? _PolicyElement;

    /// <summary>
    /// Policy or plan the activity was defined by
    /// </summary>
    /// <remarks>This uses the native .NET datatype, rather than the FHIR equivalent</remarks>
    [IgnoreDataMember]
    public IEnumerable<string?> Policy
    {
      get => _PolicyElement?.Select(elem => elem.Value) ?? [];
      set
      {
        if (value == null)
          PolicyElement = null!;
        else
          PolicyElement = new List<Hl7.Fhir.Model.FhirUri>(value.Select(elem=>new Hl7.Fhir.Model.FhirUri(elem)));
        OnPropertyChanged("Policy");
      }
    }

    /// <summary>
    /// Where the activity occurred, if relevant.
    /// </summary>
    [FhirElement("location", Order=130, FiveWs="where")]
    [CLSCompliant(false)]
    [References("Location")]
    [DataMember]
    public Hl7.Fhir.Model.ResourceReference? Location
    {
      get
      {
        if(_Location.InOverflow<Hl7.Fhir.Model.ResourceReference>())
          throw CodedValidationException.FromTypes(typeof(Hl7.Fhir.Model.ResourceReference), Overflow["location"]);
        return _Location;
      }

      set
      {
        if (_Location.InOverflow<Hl7.Fhir.Model.ResourceReference>())
          Overflow.Remove("location");
        _Location = value;
        OnPropertyChanged("Location");
      }

    }

    private Hl7.Fhir.Model.ResourceReference? _Location;

    /// <summary>
    /// Reason the activity is occurring.
    /// </summary>
    [FhirElement("reason", Order=140, FiveWs="why")]
    [Binding("ProvenanceReason")]
    [Cardinality(Min=0,Max=-1)]
    [DataMember]
    [AllowNull]
    public List<Hl7.Fhir.Model.Coding> Reason
    {
      get
      {
        if(_Reason.InOverflow<List<Hl7.Fhir.Model.Coding>>())
          throw CodedValidationException.FromTypes(typeof(List<Hl7.Fhir.Model.Coding>), Overflow["reason"]);
        return _Reason ??= [];
      }

      set
      {
        if (_Reason.InOverflow<List<Hl7.Fhir.Model.Coding>>())
          Overflow.Remove("reason");
        _Reason = value;
        OnPropertyChanged("Reason");
      }

    }

    private List<Hl7.Fhir.Model.Coding>? _Reason;

    /// <summary>
    /// Activity that occurred.
    /// </summary>
    [FhirElement("activity", Order=150, FiveWs="why")]
    [Binding("ProvenanceActivity")]
    [DataMember]
    public Hl7.Fhir.Model.Coding? Activity
    {
      get
      {
        if(_Activity.InOverflow<Hl7.Fhir.Model.Coding>())
          throw CodedValidationException.FromTypes(typeof(Hl7.Fhir.Model.Coding), Overflow["activity"]);
        return _Activity;
      }

      set
      {
        if (_Activity.InOverflow<Hl7.Fhir.Model.Coding>())
          Overflow.Remove("activity");
        _Activity = value;
        OnPropertyChanged("Activity");
      }

    }

    private Hl7.Fhir.Model.Coding? _Activity;

    /// <summary>
    /// Actor involved.
    /// </summary>
    [FhirElement("agent", Order=160, FiveWs="who")]
    [Cardinality(Min=1,Max=-1)]
    [DataMember]
    [AllowNull]
    public List<Hl7.Fhir.Model.Provenance.AgentComponent> Agent
    {
      get
      {
        if(_Agent.InOverflow<List<Hl7.Fhir.Model.Provenance.AgentComponent>>())
          throw CodedValidationException.FromTypes(typeof(List<Hl7.Fhir.Model.Provenance.AgentComponent>), Overflow["agent"]);
        return _Agent ??= [];
      }

      set
      {
        if (_Agent.InOverflow<List<Hl7.Fhir.Model.Provenance.AgentComponent>>())
          Overflow.Remove("agent");
        _Agent = value;
        OnPropertyChanged("Agent");
      }

    }

    private List<Hl7.Fhir.Model.Provenance.AgentComponent>? _Agent;

    /// <summary>
    /// An entity used in this activity.
    /// </summary>
    [FhirElement("entity", Order=170)]
    [Cardinality(Min=0,Max=-1)]
    [DataMember]
    [AllowNull]
    public List<Hl7.Fhir.Model.Provenance.EntityComponent> Entity
    {
      get
      {
        if(_Entity.InOverflow<List<Hl7.Fhir.Model.Provenance.EntityComponent>>())
          throw CodedValidationException.FromTypes(typeof(List<Hl7.Fhir.Model.Provenance.EntityComponent>), Overflow["entity"]);
        return _Entity ??= [];
      }

      set
      {
        if (_Entity.InOverflow<List<Hl7.Fhir.Model.Provenance.EntityComponent>>())
          Overflow.Remove("entity");
        _Entity = value;
        OnPropertyChanged("Entity");
      }

    }

    private List<Hl7.Fhir.Model.Provenance.EntityComponent>? _Entity;

    /// <summary>
    /// Signature on target.
    /// </summary>
    [FhirElement("signature", Order=180)]
    [Cardinality(Min=0,Max=-1)]
    [DataMember]
    [AllowNull]
    public List<Hl7.Fhir.Model.Signature> Signature
    {
      get
      {
        if(_Signature.InOverflow<List<Hl7.Fhir.Model.Signature>>())
          throw CodedValidationException.FromTypes(typeof(List<Hl7.Fhir.Model.Signature>), Overflow["signature"]);
        return _Signature ??= [];
      }

      set
      {
        if (_Signature.InOverflow<List<Hl7.Fhir.Model.Signature>>())
          Overflow.Remove("signature");
        _Signature = value;
        OnPropertyChanged("Signature");
      }

    }

    private List<Hl7.Fhir.Model.Signature>? _Signature;

    protected internal override void CopyToInternal(Base other)
    {
      if(other is not Provenance dest)
        throw new ArgumentException("Can only copy to an object of the same type", "other");

      base.CopyToInternal(dest);
      if(_Target is not null) dest.Target = new List<Hl7.Fhir.Model.ResourceReference>(_Target.DeepCopyInternal());
      if(_Period is not null) dest.Period = (Hl7.Fhir.Model.Period)_Period.DeepCopyInternal();
      if(_RecordedElement is not null) dest.RecordedElement = (Hl7.Fhir.Model.Instant)_RecordedElement.DeepCopyInternal();
      if(_PolicyElement is not null) dest.PolicyElement = new List<Hl7.Fhir.Model.FhirUri>(_PolicyElement.DeepCopyInternal());
      if(_Location is not null) dest.Location = (Hl7.Fhir.Model.ResourceReference)_Location.DeepCopyInternal();
      if(_Reason is not null) dest.Reason = new List<Hl7.Fhir.Model.Coding>(_Reason.DeepCopyInternal());
      if(_Activity is not null) dest.Activity = (Hl7.Fhir.Model.Coding)_Activity.DeepCopyInternal();
      if(_Agent is not null) dest.Agent = new List<Hl7.Fhir.Model.Provenance.AgentComponent>(_Agent.DeepCopyInternal());
      if(_Entity is not null) dest.Entity = new List<Hl7.Fhir.Model.Provenance.EntityComponent>(_Entity.DeepCopyInternal());
      if(_Signature is not null) dest.Signature = new List<Hl7.Fhir.Model.Signature>(_Signature.DeepCopyInternal());
    }

    protected internal override Base DeepCopyInternal()
    {
      var instance = new Provenance();
      CopyToInternal(instance);
      return instance;
    }

    public override bool CompareChildren(Base other, IEqualityComparer<Base> comparer)
    {
      if(other is not Provenance otherT) return false;

      if(!base.CompareChildren(otherT, comparer)) return false;
      #pragma warning disable CS8604 // Possible null reference argument - netstd2.1 has a wrong nullable signature here
      if(!comparer.ListEquals(_Target, otherT._Target)) return false;
      if(!comparer.Equals(_Period, otherT._Period)) return false;
      if(!comparer.Equals(_RecordedElement, otherT._RecordedElement)) return false;
      if(!comparer.ListEquals(_PolicyElement, otherT._PolicyElement)) return false;
      if(!comparer.Equals(_Location, otherT._Location)) return false;
      if(!comparer.ListEquals(_Reason, otherT._Reason)) return false;
      if(!comparer.Equals(_Activity, otherT._Activity)) return false;
      if(!comparer.ListEquals(_Agent, otherT._Agent)) return false;
      if(!comparer.ListEquals(_Entity, otherT._Entity)) return false;
      if(!comparer.ListEquals(_Signature, otherT._Signature)) return false;
      #pragma warning restore CS8604 // Possible null reference argument.

      return true;
    }

    public override bool TryGetValue(string key, [NotNullWhen(true)] out object? value)
    {
      switch (key)
      {
        case "target":
          if (_Target.InOverflow<List<Hl7.Fhir.Model.ResourceReference>>())
          {
            value = Overflow["target"];
            return true;
          }
          value = _Target;
          return (value as List<Hl7.Fhir.Model.ResourceReference>)?.Any() is true;
        case "period":
          if (_Period.InOverflow<Hl7.Fhir.Model.Period>())
          {
            value = Overflow["period"];
            return true;
          }
          value = _Period;
          return (value as Hl7.Fhir.Model.Period) is not null;
        case "recorded":
          if (_RecordedElement.InOverflow<Hl7.Fhir.Model.Instant>())
          {
            value = Overflow["recorded"];
            return true;
          }
          value = _RecordedElement;
          return (value as Hl7.Fhir.Model.Instant) is not null;
        case "policy":
          if (_PolicyElement.InOverflow<List<Hl7.Fhir.Model.FhirUri>>())
          {
            value = Overflow["policy"];
            return true;
          }
          value = _PolicyElement;
          return (value as List<Hl7.Fhir.Model.FhirUri>)?.Any() is true;
        case "location":
          if (_Location.InOverflow<Hl7.Fhir.Model.ResourceReference>())
          {
            value = Overflow["location"];
            return true;
          }
          value = _Location;
          return (value as Hl7.Fhir.Model.ResourceReference) is not null;
        case "reason":
          if (_Reason.InOverflow<List<Hl7.Fhir.Model.Coding>>())
          {
            value = Overflow["reason"];
            return true;
          }
          value = _Reason;
          return (value as List<Hl7.Fhir.Model.Coding>)?.Any() is true;
        case "activity":
          if (_Activity.InOverflow<Hl7.Fhir.Model.Coding>())
          {
            value = Overflow["activity"];
            return true;
          }
          value = _Activity;
          return (value as Hl7.Fhir.Model.Coding) is not null;
        case "agent":
          if (_Agent.InOverflow<List<Hl7.Fhir.Model.Provenance.AgentComponent>>())
          {
            value = Overflow["agent"];
            return true;
          }
          value = _Agent;
          return (value as List<Hl7.Fhir.Model.Provenance.AgentComponent>)?.Any() is true;
        case "entity":
          if (_Entity.InOverflow<List<Hl7.Fhir.Model.Provenance.EntityComponent>>())
          {
            value = Overflow["entity"];
            return true;
          }
          value = _Entity;
          return (value as List<Hl7.Fhir.Model.Provenance.EntityComponent>)?.Any() is true;
        case "signature":
          if (_Signature.InOverflow<List<Hl7.Fhir.Model.Signature>>())
          {
            value = Overflow["signature"];
            return true;
          }
          value = _Signature;
          return (value as List<Hl7.Fhir.Model.Signature>)?.Any() is true;
        default:
          return base.TryGetValue(key, out value);
      }

    }

    public override Base SetValue(string key, object? value)
    {
      if(value is not (null or Hl7.Fhir.Model.Base or IList)) throw new ArgumentException("Value must be a Base or a list of Base", nameof(value));
      switch (key)
      {
        case "target":
          if (value is not (List<Hl7.Fhir.Model.ResourceReference> or null))
          {
            Target = OverflowNull<List<Hl7.Fhir.Model.ResourceReference>>.INSTANCE;
            Overflow["target"] = value;
          }
          else Target = (List<Hl7.Fhir.Model.ResourceReference>?)value!;
          return this;
        case "period":
          if (value is not (Hl7.Fhir.Model.Period or null))
          {
            Period = OverflowNull<Hl7.Fhir.Model.Period>.INSTANCE;
            Overflow["period"] = value;
          }
          else Period = (Hl7.Fhir.Model.Period?)value;
          return this;
        case "recorded":
          if (value is not (Hl7.Fhir.Model.Instant or null))
          {
            RecordedElement = OverflowNull<Hl7.Fhir.Model.Instant>.INSTANCE;
            Overflow["recorded"] = value;
          }
          else RecordedElement = (Hl7.Fhir.Model.Instant?)value!;
          return this;
        case "policy":
          if (value is not (List<Hl7.Fhir.Model.FhirUri> or null))
          {
            PolicyElement = OverflowNull<List<Hl7.Fhir.Model.FhirUri>>.INSTANCE;
            Overflow["policy"] = value;
          }
          else PolicyElement = (List<Hl7.Fhir.Model.FhirUri>?)value!;
          return this;
        case "location":
          if (value is not (Hl7.Fhir.Model.ResourceReference or null))
          {
            Location = OverflowNull<Hl7.Fhir.Model.ResourceReference>.INSTANCE;
            Overflow["location"] = value;
          }
          else Location = (Hl7.Fhir.Model.ResourceReference?)value;
          return this;
        case "reason":
          if (value is not (List<Hl7.Fhir.Model.Coding> or null))
          {
            Reason = OverflowNull<List<Hl7.Fhir.Model.Coding>>.INSTANCE;
            Overflow["reason"] = value;
          }
          else Reason = (List<Hl7.Fhir.Model.Coding>?)value!;
          return this;
        case "activity":
          if (value is not (Hl7.Fhir.Model.Coding or null))
          {
            Activity = OverflowNull<Hl7.Fhir.Model.Coding>.INSTANCE;
            Overflow["activity"] = value;
          }
          else Activity = (Hl7.Fhir.Model.Coding?)value;
          return this;
        case "agent":
          if (value is not (List<Hl7.Fhir.Model.Provenance.AgentComponent> or null))
          {
            Agent = OverflowNull<List<Hl7.Fhir.Model.Provenance.AgentComponent>>.INSTANCE;
            Overflow["agent"] = value;
          }
          else Agent = (List<Hl7.Fhir.Model.Provenance.AgentComponent>?)value!;
          return this;
        case "entity":
          if (value is not (List<Hl7.Fhir.Model.Provenance.EntityComponent> or null))
          {
            Entity = OverflowNull<List<Hl7.Fhir.Model.Provenance.EntityComponent>>.INSTANCE;
            Overflow["entity"] = value;
          }
          else Entity = (List<Hl7.Fhir.Model.Provenance.EntityComponent>?)value!;
          return this;
        case "signature":
          if (value is not (List<Hl7.Fhir.Model.Signature> or null))
          {
            Signature = OverflowNull<List<Hl7.Fhir.Model.Signature>>.INSTANCE;
            Overflow["signature"] = value;
          }
          else Signature = (List<Hl7.Fhir.Model.Signature>?)value!;
          return this;
        default:
          return base.SetValue(key, value);
      }

    }

    public override IEnumerable<KeyValuePair<string, object>> EnumerateElements()
    {
      foreach (var kvp in base.EnumerateElements()) yield return kvp;
      if (_Target?.Any() is true && !_Target.InOverflow<List<Hl7.Fhir.Model.ResourceReference>>()) yield return new KeyValuePair<string,object>("target",_Target);
      if (_Period is not null && !_Period.InOverflow<Hl7.Fhir.Model.Period>()) yield return new KeyValuePair<string,object>("period",_Period);
      if (_RecordedElement is not null && !_RecordedElement.InOverflow<Hl7.Fhir.Model.Instant>()) yield return new KeyValuePair<string,object>("recorded",_RecordedElement);
      if (_PolicyElement?.Any() is true && !_PolicyElement.InOverflow<List<Hl7.Fhir.Model.FhirUri>>()) yield return new KeyValuePair<string,object>("policy",_PolicyElement);
      if (_Location is not null && !_Location.InOverflow<Hl7.Fhir.Model.ResourceReference>()) yield return new KeyValuePair<string,object>("location",_Location);
      if (_Reason?.Any() is true && !_Reason.InOverflow<List<Hl7.Fhir.Model.Coding>>()) yield return new KeyValuePair<string,object>("reason",_Reason);
      if (_Activity is not null && !_Activity.InOverflow<Hl7.Fhir.Model.Coding>()) yield return new KeyValuePair<string,object>("activity",_Activity);
      if (_Agent?.Any() is true && !_Agent.InOverflow<List<Hl7.Fhir.Model.Provenance.AgentComponent>>()) yield return new KeyValuePair<string,object>("agent",_Agent);
      if (_Entity?.Any() is true && !_Entity.InOverflow<List<Hl7.Fhir.Model.Provenance.EntityComponent>>()) yield return new KeyValuePair<string,object>("entity",_Entity);
      if (_Signature?.Any() is true && !_Signature.InOverflow<List<Hl7.Fhir.Model.Signature>>()) yield return new KeyValuePair<string,object>("signature",_Signature);
    }

  }

}

// end of file
